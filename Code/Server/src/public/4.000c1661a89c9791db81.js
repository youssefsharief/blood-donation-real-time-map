(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{LN1V:function(n,e,o){"use strict";o.r(e);var r=o("CcnG"),t=function(){return function(){}}(),l=o("pMnS"),i=o("r6rm"),u=function(){function n(){}return n.prototype.isLoaded=function(){return Object(i.isLoaded)()},n.prototype.load=function(n){return new Promise(function(e,o){Object(i.isLoaded)()&&e(i.dojoRequire),Object(i.bootstrap)(function(n){n?o(n):e(i.dojoRequire)},n)})},n.prototype.loadModules=function(n){return new Promise(function(e){Object(i.dojoRequire)(n,function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];e(n)})})},n.prototype.require=function(n,e){return Object(i.dojoRequire)(n,e)},n}(),a=function(){return function(){}}(),s=[31.2,30],c=o("iiaH"),d=o("z7KK");function p(n,e,o){var r;return function(){var t=this,l=arguments,i=o&&!r;clearTimeout(r),r=setTimeout(function(){r=null,o||n.apply(t,l)},e),i&&n.apply(t,l)}}var f=o("kmKP"),b=function(){function n(n,e,o){this.router=n,this.userService=e,this.graphicsService=o}return n.prototype.implement=function(n,e){var o=this,r=new e({url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"});n.on("double-click",function(e){e.stopPropagation();var t=e.mapPoint.longitude,l=e.mapPoint.latitude;r.locationToAddress(e.mapPoint).then(function(r){return o.showPopup(n,e.mapPoint,r.address)}).otherwise(function(r){return o.showPopup(n,e.mapPoint,"none")}),n.popup.on("trigger-action",function(n){"show-add-modal"===n.action.id&&(o.saveLocation(t,l,"none"),o.router.navigate(["/posting"]))})})},n.prototype.showPopup=function(n,e,o){this.graphicsService.showAddingPopup(n,e,o)},n.prototype.saveLocation=function(n,e,o){this.userService.saveLocation(n,e,o)},n}(),h=function(){function n(n,e){this.dataService=n,this.mapDoubleClickHandler=e}return n.prototype.askForData=function(n){return this.dataService.getNearbyDonors(n.center.longitude,n.center.latitude)},n.prototype.assignMapEventHandlers=function(n,e){var o=this;console.log(n),n.on("drag",p(function(){return o.askForData(n)},25)),n.on("mouse-wheel",p(function(){return o.askForData(n)},25)),n.on("hold",p(function(){return o.askForData(n)},25)),this.mapDoubleClickHandler.implement(n,e),function(n){n.popup.on("trigger-action",function(n){var e,o;"show-hidden"===n.action.id&&(o=(e=document.querySelector(".esri-popup-renderer").childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0]).childNodes[4].childNodes[1].childNodes[0].attributes.data.value,e.childNodes[3].childNodes[1].childNodes[0].innerText=e.childNodes[3].childNodes[1].childNodes[0].attributes.data.value,e.childNodes[4].childNodes[1].childNodes[0].innerText=o)})}(n),n.then(function(e){return o.askForData(n)})},n}(),v=function(){function n(n,e,o){this.dataService=n,this.graphicsService=e,this.mapCoreEventsHandler=o}return n.prototype.loadMap=function(n,e){var o=this,r=e[2],t=e[3],l=e[4],i=e[5],u=e[6],a=e[7],c=new(0,e[1])({container:n,map:new(0,e[0])({basemap:"osm"}),center:s,zoom:10});this.dataService.nearbyDonorsSubscription.subscribe(function(n){return o.graphicsService.setGraphicsFromData(c,a,u,i,n)},function(n){return console.log("Problem with socket connector")}),function(n,e,o){var r=new e({view:n}),t=new o({view:n});n.ui.add(r,"top-left"),n.ui.add(t,{position:"top-left",index:2})}(c,r,t),this.mapCoreEventsHandler.assignMapEventHandlers(c,l)},n}(),m=function(){function n(n,e){this.esriLoader=n,this.mapCoreService=e}return n.prototype.ngOnInit=function(){this.loadFromRemoteSource()},n.prototype.loadFromRemoteSource=function(){var n=this;return this.esriLoader.load({url:"https://js.arcgis.com/4.4/"}).then(function(){return n.loadMap()})},n.prototype.loadModules=function(){return this.esriLoader.loadModules(["esri/Map","esri/views/MapView","esri/widgets/Track","esri/widgets/Search","esri/tasks/Locator","esri/Graphic","esri/geometry/Point","esri/symbols/SimpleMarkerSymbol"])},n.prototype.loadMap=function(){var n=this;return this.loadModules().then(function(e){n.mapCoreService.loadMap(n.mapViewEl.nativeElement,e)})},n}(),w=r.pb({encapsulation:0,styles:[["@import url(https://js.arcgis.com/4.4/esri/css/main.css);"]],data:{}});function g(n){return r.Gb(0,[r.Db(402653184,1,{mapViewEl:0}),(n()(),r.rb(1,0,null,null,15,"div",[["class","container"]],null,null,null,null,null)),(n()(),r.rb(2,0,null,null,12,"div",[["class","row"]],null,null,null,null,null)),(n()(),r.rb(3,0,null,null,5,"div",[["class","col-md-6 text-center"]],null,null,null,null,null)),(n()(),r.rb(4,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-heartbeat"]],null,null,null,null,null)),(n()(),r.rb(5,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),r.Fb(-1,null,[" For Patients"])),(n()(),r.rb(7,0,null,null,1,"p",[["class","text-muted"]],null,null,null,null,null)),(n()(),r.Fb(-1,null,['Click on the putple pins to get info of donors near you and then press on "Show phone and email" to contact them'])),(n()(),r.rb(9,0,null,null,5,"div",[["class","col-md-6 text-center"]],null,null,null,null,null)),(n()(),r.rb(10,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-heart-o"]],null,null,null,null,null)),(n()(),r.rb(11,0,null,null,1,"h1",[],null,null,null,null,null)),(n()(),r.Fb(-1,null,[" For Donors"])),(n()(),r.rb(13,0,null,null,1,"p",[["class","text-muted"]],null,null,null,null,null)),(n()(),r.Fb(-1,null,['Chose your location by double-clicking on the map, then press "Confirm Location" '])),(n()(),r.rb(15,0,[[1,0],["mapViewNode",1]],null,1,"div",[],null,null,null,null,null)),(n()(),r.rb(16,0,null,null,0,"div",[["class","loader"]],null,null,null,null,null))],null,null)}function z(n){return r.Gb(0,[(n()(),r.rb(0,0,null,null,1,"esri-map",[],null,null,null,g,w)),r.qb(1,114688,null,0,m,[u,v],null,null)],function(n,e){n(e,1,0)},null)}var y=r.nb("esri-map",m,z,{},{},[]),S=o("xYTU"),j=o("Ip0R"),P=o("gIcY"),k=o("eDkP"),N=o("Fzqc"),q=o("sE5F"),C=o("ZYCi"),E=function(){return function(){}}(),L=o("4c35"),M=o("dWZg"),A=o("qAlS"),F=o("Wf4p"),D=o("ZYjt"),T=o("UodH"),x=o("vARd"),I=o("PCNd");o.d(e,"EsriMapModuleNgFactory",function(){return R});var R=r.ob(t,[],function(n){return r.yb([r.zb(512,r.j,r.db,[[8,[l.a,y,S.a,S.b]],[3,r.j],r.y]),r.zb(4608,j.k,j.j,[r.v,[2,j.r]]),r.zb(4608,P.t,P.t,[]),r.zb(4608,P.d,P.d,[]),r.zb(4608,k.a,k.a,[k.g,k.c,r.j,k.f,k.d,r.r,r.A,j.c,N.b,[2,j.f]]),r.zb(5120,k.h,k.i,[k.a]),r.zb(4608,q.c,q.c,[]),r.zb(4608,q.i,q.b,[]),r.zb(5120,q.k,q.l,[]),r.zb(4608,q.j,q.j,[q.c,q.i,q.k]),r.zb(4608,q.g,q.a,[]),r.zb(5120,q.e,q.m,[q.j,q.g]),r.zb(4608,u,u,[]),r.zb(4608,b,b,[C.k,f.a,d.a]),r.zb(4608,h,h,[c.a,b]),r.zb(4608,v,v,[c.a,d.a,h]),r.zb(1073742336,C.l,C.l,[[2,C.r],[2,C.k]]),r.zb(1073742336,E,E,[]),r.zb(1073742336,j.b,j.b,[]),r.zb(1073742336,P.r,P.r,[]),r.zb(1073742336,P.g,P.g,[]),r.zb(1073742336,P.n,P.n,[]),r.zb(1073742336,N.a,N.a,[]),r.zb(1073742336,L.f,L.f,[]),r.zb(1073742336,M.b,M.b,[]),r.zb(1073742336,A.b,A.b,[]),r.zb(1073742336,k.e,k.e,[]),r.zb(1073742336,F.c,F.c,[[2,F.a],[2,D.g]]),r.zb(1073742336,F.e,F.e,[]),r.zb(1073742336,T.c,T.c,[]),r.zb(1073742336,x.e,x.e,[]),r.zb(1073742336,q.f,q.f,[]),r.zb(1073742336,I.a,I.a,[]),r.zb(1073742336,a,a,[]),r.zb(1073742336,t,t,[]),r.zb(1024,C.i,function(){return[[{path:"",component:m}]]},[])])})},r6rm:function(n,e,o){!function(n){"use strict";var e,o="undefined"!=typeof window,r="https://js.arcgis.com/4.6/";function t(){var n=window.require;return n&&n.on}function l(n){var e=document.createElement("script");return e.type="text/javascript",e.src=n,e.setAttribute("data-esri-loader","loading"),e}function i(n,e,o){var r;o&&(r=u(n,o));var t=function(){e(n),n.removeEventListener("load",t,!1),r&&n.removeEventListener("error",r,!1)};n.addEventListener("load",t,!1)}function u(n,e){var o=function(r){e(r.error||new Error("There was an error attempting to load "+n.src)),n.removeEventListener("error",o,!1)};return n.addEventListener("error",o,!1),o}var a={Promise:o?window.Promise:void 0};function s(){return document.querySelector("script[data-esri-loader]")}function c(){return void 0!==window.require&&s()}function d(n){return void 0===n&&(n={}),n.url||(n.url=r),new a.Promise(function(o,r){var u=s();if(u){var a=u.getAttribute("src");a!==n.url?r(new Error("The ArcGIS API for JavaScript is already loaded ("+a+").")):t()?o(u):i(u,o,r)}else t()?r(new Error("The ArcGIS API for JavaScript is already loaded.")):(n.dojoConfig&&(window.dojoConfig=n.dojoConfig),u=l(n.url),e=n.url,i(u,function(){u.setAttribute("data-esri-loader","loaded"),o(u)},r),document.body.appendChild(u))})}function p(n){return new a.Promise(function(e,o){var r=window.require.on("error",o);window.require(n,function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];r.remove(),e(n)})})}function f(n,o){return void 0===o&&(o={}),t()?p(n):(!o.url&&e&&(o.url=e),d(o).then(function(){return p(n)}))}function b(n,e){if(void 0===e&&(e={}),console.warn("bootstrap() has been depricated and will be removed the next major release. Use loadScript() instead."),e.url||(e.url=r),s())n&&n(new Error("The ArcGIS API for JavaScript is already loaded."));else{e.dojoConfig&&(window.dojoConfig=e.dojoConfig);var o=l(e.url);o.onload=function(){o.setAttribute("data-esri-loader","loaded");var e=window.require;n&&n(null,e)},n&&u(o,n),document.body.appendChild(o)}}function h(n,e){if(console.warn("dojoRequire() has been depricated and will be removed the next major release. Use loadModules() instead."),c())window.require(n,e);else{var o=s();if(!o)throw new Error("The ArcGIS API for JavaScript has not been loaded. You must first call esriLoader.bootstrap()");i(o,function(){window.require(n,e)})}}var v={getScript:s,isLoaded:c,loadModules:f,loadScript:d,utils:a,bootstrap:b,dojoRequire:h};n.utils=a,n.getScript=s,n.isLoaded=c,n.loadScript=d,n.loadModules=f,n.bootstrap=b,n.dojoRequire=h,n.default=v,Object.defineProperty(n,"__esModule",{value:!0})}(e)}}]);